import asyncio
import argparse
import os
from core.task_executor import TaskExecutor

# --- ููุทู ุดุฑูุน ุงุตู ุจุฑูุงูู (Entrypoint) ---
async def main():
    """
    ุงู ุชุงุจุน ุงุตู ุจุฑูุงูู ุงุณุช ฺฉู ููฺฏุงู ุงุฌุฑุง ุงุณฺฉุฑูพุช ูุฑุงุฎูุงู ูโุดูุฏ.
    ูุธูู ุขูุ ุฎูุงูุฏู ุขุฑฺฏููุงูโูุง ูุฑูุฏ (ID ุงุฌูุช) ู ุดุฑูุน ุจู ฺฉุงุฑ TaskExecutor ุงุณุช.
    """
    # ฺฉ ูพุงุฑุณุฑ ุจุฑุง ุฎูุงูุฏู ุขุฑฺฏููุงูโูุง ุฎุท ูุฑูุงู (command-line) ุงุฌุงุฏ ูโฺฉูู.
    parser = argparse.ArgumentParser(description="ุฑุจุงุช ูพุฑุฏุงุฒุดฺฏุฑ ููฺฉโูุง")

    # ุขุฑฺฏููุงู agent-id-- ุฑุง ุชุนุฑู ูโฺฉูู. ุงู ุขุฑฺฏููุงู ูุดุฎุต ูโฺฉูุฏ ฺฉู ฺฉุฏุงู ุงุฌูุช ุจุงุฏ ุงุฌุฑุง ุดูุฏ.
    # ููุฏุงุฑ ูพุดโูุฑุถ ุขู ุงุฒ ูุชุบุฑ ูุญุท AGENT_ID ุฎูุงูุฏู ูโุดูุฏ ู ุงฺฏุฑ ุขู ูู ูุฌูุฏ ูุฏุงุดุชุ ฑ ุฎูุงูุฏ ุจูุฏ.
    parser.add_argument(
        "--agent-id",
        type=int,
        default=int(os.getenv('AGENT_ID', 1)),
        help="ุดูุงุณู ุงุฌูุช ุจุฑุง ุงุฌุฑุง (ูุซูุงู ฑุ ฒุ ณ ุง ด)"
    )
    args = parser.parse_args()
    
    # ฺฉ ููููู ุงุฒ TaskExecutor ุจุง ุดูุงุณู ูุดุฎุต ุดุฏู ุงุฌุงุฏ ฺฉุฑุฏู ู ุชุณฺฉโูุง ุฑูุฒุงูู ุขู ุฑุง ุงุฌุฑุง ูโฺฉูู.
    executor = TaskExecutor(agent_id=args.agent_id)
    await executor.run_daily_tasks()

if __name__ == "__main__":
    # ุงู ุจุฎุด ุชุถูู ูโฺฉูุฏ ฺฉู ฺฉุฏ ููุท ุฒูุงู ุงุฌุฑุง ุดูุฏ ฺฉู ูุงู ูุณุชููุงู ูุฑุงุฎูุงู ุดุฏู ุจุงุดุฏ (ู ูู ุจู ุนููุงู ูุงฺูู).
    # asyncio.run(main()) ุชุงุจุน main ูุงููุฒูุงู (async) ูุง ุฑุง ุงุฌุฑุง ูโฺฉูุฏ.
    try:
        asyncio.run(main())
    except KeyboardInterrupt:
        print("\n๐ ุจุฑูุงูู ุชูุณุท ฺฉุงุฑุจุฑ ูุชููู ุดุฏ.")